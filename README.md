## `release_notes.groovy`

**Deterministic release notes generator (no LLM).**

This Groovy script processes the **raw release notes** generated automatically by  
[**marvinpinto/action-automatic-releases**](https://github.com/marvinpinto/action-automatic-releases)  
and reorganizes them into a structured, human-readable Markdown document.

---

### How It Works

The **marvinpinto automatic releases** GitHub Action creates release notes that include a simple list of commits under a `## Commits` section.  
Each commit line typically follows this format:

````markdown
## Commits

- <short-hash>: <commit message> (<author>) [#<PR-number>](<PR-URL>)
````

For example:

````markdown
## Commits

- 1039639: Bump com.akathist.maven.plugins.launch4j:launch4j-maven-plugin (#173) (dependabot[bot]) [#173](https://github.com/nbauma109/jd-gui-duo/pull/173)
- 54fe297: change archive format to tar.xz (nbauma109)
- bf7a328: Update README.md download links to tar.xz files (nbauma109)
````

This script reads that section and deterministically performs the following steps:

1. **Extracts** only the commit bullets found under the `## Commits` section.  
2. **Filters out** commits created by:
   - the *Maven Release Plugin* (`[maven-release-plugin]`)
   - merge commits  
3. **Parses** each commit line into:
   - commit hash  
   - message  
   - author  
   - PR references (`(#123)` or `[#123](URL)`)  
4. **Classifies** each commit into one of the following categories:
   - **Features & highlights**  
   - **Bug fixes**  
   - **Improvements**  
   - **Dependencies**
     - Runtime dependencies  
     - Test dependencies  
     - Maven plugins  
     - GitHub actions & workflow  
   - **Chores & Maintenance**  
   - **Build & Packaging**
     - YAML files  
     - Scripts  
     - Core build logic  
   - **Documentation**  
5. **Merges dependency bumps** for the same artifact:
   - When version numbers are available, they are summarized as:
     ```markdown
     - <first-hash>: Bump <artifact> from <min> to <max>  (also: <other-hashes>) <PR refs>
     ```
   - When version numbers are missing, the script attempts to **fetch the pull request title** from the linked PR URL(s) to extract them.  
   - If still unresolved, it outputs the **original commit line** unchanged.  
6. **Adds icons** to section headers for readability.  
7. **Outputs** a clean, deterministic Markdown document suitable for inclusion in a GitHub release.

---

### Example Usage

```bash
groovy release_notes.groovy commits.txt > RELEASE_NOTES.md
```

Where `commits.txt` is the body of a release generated by  
**marvinpinto/action-automatic-releases**, which includes a `## Commits` section.

---

### Why Use This Script

The release notes produced by *marvinpinto/action-automatic-releases* are consistent but **unstructured** —  
they contain a flat list of commit lines without grouping or summarization.

`release_notes.groovy` converts that flat list into a **well-organized, human-friendly changelog**,  
with logical sections, dependency merging, and consistent Markdown formatting —  
all **without** using any large language model and **without** altering commit content.

The result is **clean, repeatable, and fully automatable**, making it ideal for CI/CD workflows.
